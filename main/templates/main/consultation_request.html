{% extends 'main/base.html' %}

{% block title %}درخواست مشاوره حقوقی | مشاوره با وکیل و قاضی بازنشسته - عدل‌بان{% endblock %}

{% block breadcrumb %}
<!-- Breadcrumb -->
<div class="container mx-auto px-4 py-4">
    <nav class="flex text-sm text-gray-600 dark:text-gray-400">
        <a href="{% url 'main:home' %}" class="hover:text-theme dark:hover:text-theme-light transition-colors">خانه</a>
        <span class="mx-2">›</span>
        <span class="text-theme dark:text-theme-light font-semibold">درخواست مشاوره</span>
    </nav>
</div>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative bg-gradient-to-l from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800 overflow-hidden">
    <!-- Animated Background Elements -->
    <div class="absolute inset-0">
        <div class="absolute top-20 left-10 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-float"></div>
        <div class="absolute bottom-20 right-10 w-72 h-72 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-float" style="animation-delay: 2s"></div>
    </div>
    
    <div class="container mx-auto px-4 py-12 md:py-24 relative">
        <div class="max-w-4xl mx-auto text-center">
            <span class="inline-block bg-gradient-to-r from-theme/10 to-purple-500/10 text-theme dark:text-theme-light px-4 py-2 rounded-full font-semibold mb-6 animate-fade-in-up">
                <i class="fas fa-calendar-check ml-2"></i>
                رزرو مشاوره حقوقی
            </span>
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6 leading-tight animate-fade-in-up" style="animation-delay: 0.1s">
                <span class="gradient-text">درخواست مشاوره تخصصی</span><br>
                با وکلای پایه یک و قضات بازنشسته
            </h1>
            <p class="text-xl text-gray-600 dark:text-gray-300 mb-8 leading-relaxed animate-fade-in-up" style="animation-delay: 0.2s">
                فرم زیر را تکمیل کنید تا در اسرع وقت با شما تماس گرفته شود و وقت مشاوره تخصصی شما تنظیم گردد.
            </p>
        </div>
    </div>
    
    <!-- Wave Shape -->
    <div class="absolute bottom-0 right-0 left-0">
        <svg viewBox="0 0 1200 120" preserveAspectRatio="none" class="w-full h-16 text-white dark:text-gray-900">
            <path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="currentColor"></path>
            <path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35,6.36,119.13-6.29,75-23.79,133.11-90.3,138.47-167.2,4.36-67.3-24.41-128.84-73.6-171.55C1099.49,5,1023.93,6.26,972.11,28.44,924.88,48.81,872.24,72.11,823,97.67,776.67,122.43,727.85,135.24,679,129.93,627.34,124.24,575.67,103.86,527.82,81.18,478.18,57.69,431.15,29.72,386.83,0Z" opacity=".5" fill="currentColor"></path>
            <path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="currentColor"></path>
        </svg>
    </div>
</section>

<!-- Consultation Form Section -->
<section class="py-20 bg-white dark:bg-gray-900">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <div class="bg-gradient-to-br from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 md:p-12 border border-gray-200 dark:border-gray-700">
                
                {% if messages %}
                    {% for message in messages %}
                        <div class="mb-6 p-4 rounded-lg {% if message.tags == 'success' %}bg-green-100 text-green-700 border border-green-200{% elif message.tags == 'error' %}bg-red-100 text-red-700 border border-red-200{% else %}bg-blue-100 text-blue-700 border border-blue-200{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}

                <form method="post" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Personal Information -->
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                            <i class="fas fa-user ml-3 text-theme"></i>
                            اطلاعات شخصی
                        </h3>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    نام و نام خانوادگی <span class="text-red-500">*</span>
                                </label>
                                {{ form.name }}
                                {% if form.name.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.name.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    شماره تماس <span class="text-red-500">*</span>
                                </label>
                                {{ form.phone }}
                                {% if form.phone.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.phone.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    ایمیل
                                </label>
                                {{ form.email }}
                                {% if form.email.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.email.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="{{ form.consultation_type.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    نوع مشاوره <span class="text-red-500">*</span>
                                </label>
                                {{ form.consultation_type }}
                                {% if form.consultation_type.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.consultation_type.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Consultation Details -->
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                            <i class="fas fa-gavel ml-3 text-theme"></i>
                            جزئیات مشاوره
                        </h3>
                        
                        <div class="space-y-6">
                            <div>
                                <label for="{{ form.subject.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    موضوع مشاوره <span class="text-red-500">*</span>
                                </label>
                                {{ form.subject }}
                                {% if form.subject.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.subject.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    توضیحات کامل پرونده <span class="text-red-500">*</span>
                                </label>
                                {{ form.description }}
                                {% if form.description.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.description.errors.0 }}
                                    </div>
                                {% endif %}
                                <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                                    لطفاً تمام جزئیات مربوط به پرونده خود را به طور کامل توضیح دهید تا بتوانیم بهترین مشاور را برای شما انتخاب کنیم.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preferred Time -->
                    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-200 dark:border-gray-700">
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                            <i class="fas fa-clock ml-3 text-theme"></i>
                            زمان پیشنهادی
                        </h3>
                        
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label for="{{ form.preferred_date.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    تاریخ پیشنهادی <span class="text-red-500">*</span>
                                </label>
                                {{ form.preferred_date }}
                                {% if form.preferred_date.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.preferred_date.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="{{ form.preferred_time.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    ساعت پیشنهادی <span class="text-red-500">*</span>
                                </label>
                                {{ form.preferred_time }}
                                {% if form.preferred_time.errors %}
                                    <div class="mt-1 text-sm text-red-600">
                                        {{ form.preferred_time.errors.0 }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Submit Button -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button type="submit" class="bg-gradient-to-r from-theme to-purple-600 hover:from-theme-dark hover:to-purple-700 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300 hover:shadow-xl hover:scale-105 flex items-center justify-center group">
                            <i class="fas fa-paper-plane ml-2 group-hover:animate-bounce"></i>
                            ارسال درخواست مشاوره
                        </button>
                        <a href="tel:09129413828" class="bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300 hover:shadow-xl hover:scale-105 flex items-center justify-center group">
                            <i class="fas fa-phone ml-2 group-hover:animate-shake"></i>
                            تماس فوری
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Recent Consultation Requests Table (for admin view) -->
{% if user.is_authenticated and user.is_staff %}
<section class="py-20 bg-gray-50 dark:bg-gray-800">
    <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
                    درخواست‌های اخیر مشاوره
                </h2>
                <p class="text-gray-600 dark:text-gray-300">
                    مدیریت و پیگیری درخواست‌های مشاوره
                </p>
            </div>
            
            <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700">
                            <tr>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">نام</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">تلفن</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">نوع مشاوره</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">موضوع</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">تاریخ درخواست</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">وضعیت</th>
                                <th class="px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white">عملیات</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                            {% for request in consultation_requests %}
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
                                <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">{{ request.name }}</td>
                                <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">{{ request.phone }}</td>
                                <td class="px-6 py-4 text-sm">
                                    <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                                        {{ request.get_consultation_type_display }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">{{ request.subject|truncatechars:30 }}</td>
                                <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">{{ request.created_at|date:"Y/m/d" }}</td>
                                <td class="px-6 py-4 text-sm">
                                    <span class="px-2 py-1 text-xs rounded-full 
                                        {% if request.status == 'pending' %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200
                                        {% elif request.status == 'approved' %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200
                                        {% elif request.status == 'rejected' %}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200
                                        {% else %}bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200{% endif %}">
                                        {{ request.get_status_display }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 text-sm">
                                    <a href="#" class="text-theme hover:text-theme-dark ml-2">مشاهده</a>
                                    <a href="#" class="text-green-600 hover:text-green-700">پاسخ</a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" class="px-6 py-8 text-center text-gray-500 dark:text-gray-400">
                                    هیچ درخواست مشاوره‌ای یافت نشد.
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block extra_css %}
<style>
    /* Form styling */
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"],
    input[type="time"],
    select,
    textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: white;
        color: #1f2937;
    }

    .dark input[type="text"],
    .dark input[type="email"],
    .dark input[type="tel"],
    .dark input[type="date"],
    .dark input[type="time"],
    .dark select,
    .dark textarea {
        background: #1f2937;
        border-color: #374151;
        color: #f9fafb;
    }

    input:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .dark input:focus,
    .dark select:focus,
    .dark textarea:focus {
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    }

    textarea {
        resize: vertical;
        min-height: 120px;
    }

    /* Table styling */
    table {
        border-collapse: collapse;
    }

    th {
        font-weight: 600;
    }

    tr:hover {
        transform: translateY(-1px);
    }
</style>
{% endblock %}