{% extends 'main/base.html' %} {% block title %}سوالات حقوقی - پرسش و پاسخ{% endblock %} {% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Page Header -->
    <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">
            <i class="fas fa-question-circle text-primary-600 ml-3"></i>
            سوالات حقوقی
        </h1>
        <p class="text-gray-600 dark:text-gray-300 text-lg max-w-2xl mx-auto">
            به آرشیو سوالات حقوقی خوش آمدید. می‌توانید سوالات را بر اساس دسته‌بندی فیلتر کرده و مرتب کنید.
        </p>
    </div>

    <!-- Statistics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">کل سوالات</p>
                    <p class="text-2xl font-bold text-gray-900 dark:text-white">{{ total_questions }}</p>
                </div>
                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center">
                    <i class="fas fa-list text-blue-600 dark:text-blue-400"></i>
                </div>
            </div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">پاسخ داده شده</p>
                    <p class="text-2xl font-bold text-green-600 dark:text-green-400">{{ answered_questions }}</p>
                </div>
                <div class="w-12 h-12 bg-green-100 dark:bg-green-900/50 rounded-lg flex items-center justify-center">
                    <i class="fas fa-check-circle text-green-600 dark:text-green-400"></i>
                </div>
            </div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-500 dark:text-gray-400 text-sm">بدون پاسخ</p>
                    <p class="text-2xl font-bold text-orange-600 dark:text-orange-400">{{ unanswered_questions }}</p>
                </div>
                <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/50 rounded-lg flex items-center justify-center">
                    <i class="fas fa-clock text-orange-600 dark:text-orange-400"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters and Sorting -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg mb-8 border border-gray-200 dark:border-gray-700">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Category Filter -->
            <div>
                <label for="category-filter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    <i class="fas fa-filter ml-2"></i>فیلتر دسته‌بندی
                </label>
                <select 
                    id="category-filter" 
                    onchange="applyFilters()"
                    class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                >
                    <option value="all" {% if current_category == 'all' %}selected{% endif %}>همه دسته‌بندی‌ها</option>
                    {% for category, label in category_choices %}
                    <option value="{{ category }}" {% if current_category == category %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Sort Options -->
            <div>
                <label for="sort-options" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    <i class="fas fa-sort ml-2"></i>مرتب‌سازی
                </label>
                <select 
                    id="sort-options" 
                    onchange="applyFilters()"
                    class="w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                >
                    <option value="newest" {% if current_sort == 'newest' %}selected{% endif %}>جدیدترین</option>
                    <option value="oldest" {% if current_sort == 'oldest' %}selected{% endif %}>قدیمی‌ترین</option>
                    <option value="answered" {% if current_sort == 'answered' %}selected{% endif %}>پاسخ داده شده</option>
                    <option value="unanswered" {% if current_sort == 'unanswered' %}selected{% endif %}>بدون پاسخ</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Questions List -->
    <div class="space-y-6">
        {% for question in questions %}
        <article class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-shadow duration-300">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <!-- Question Title and Category -->
                    <div class="flex items-center gap-3 mb-3">
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                            <a href="{{ question.get_absolute_url }}" class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                                {{ question.question }}
                            </a>
                        </h3>
                        <span class="inline-block px-3 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-full text-sm font-medium">
                            {{ question.get_category_display }}
                        </span>
                        {% if question.is_answered %}
                        <span class="inline-block px-3 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded-full text-sm font-medium">
                            <i class="fas fa-check ml-1"></i>پاسخ داده شده
                        </span>
                        {% else %}
                        <span class="inline-block px-3 py-1 bg-orange-100 dark:bg-orange-900/50 text-orange-700 dark:text-orange-300 rounded-full text-sm font-medium">
                            <i class="fas fa-clock ml-1"></i>بدون پاسخ
                        </span>
                        {% endif %}
                    </div>
                    
                    <!-- Question Description -->
                    {% if question.description %}
                    <p class="text-gray-600 dark:text-gray-300 mb-4 line-clamp-3">
                        {{ question.description }}
                    </p>
                    {% endif %}
                    
                    <!-- Question Meta -->
                    <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                        <div class="flex items-center gap-4">
                            <span>
                                <i class="fas fa-calendar ml-1"></i>
                                {{ question.created_at|date:"Y/m/d" }}
                            </span>
                            {% if question.questioner_name %}
                            <span>
                                <i class="fas fa-user ml-1"></i>
                                {{ question.questioner_name }}
                            </span>
                            {% endif %}
                            <span>
                                <i class="fas fa-comments ml-1"></i>
                                {{ question.answers_count }} پاسخ
                            </span>
                        </div>
                        <a href="{{ question.get_absolute_url }}" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium">
                            مشاهده پاسخ‌ها
                            <i class="fas fa-arrow-left mr-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </article>
        {% empty %}
        <div class="bg-gray-50 dark:bg-gray-800 rounded-xl p-12 text-center border border-gray-200 dark:border-gray-700">
            <i class="fas fa-search text-6xl text-gray-400 dark:text-gray-500 mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">سوالی یافت نشد</h3>
            <p class="text-gray-600 dark:text-gray-300">
                با فیلترهای انتخاب شده هیچ سوالی وجود ندارد. لطفاً فیلترها را تغییر دهید.
            </p>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
    <div class="mt-12 flex justify-center">
        <nav class="flex items-center space-x-2 space-x-reverse">
            {% if page_obj.has_previous %}
            <a href="?{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ page_obj.previous_page_number }}" 
               class="px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-arrow-right"></i>
            </a>
            {% endif %}
            
            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <span class="px-4 py-2 bg-primary-600 text-white rounded-lg">{{ num }}</span>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a href="?{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ num }}" 
                   class="px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}
            
            {% if page_obj.has_next %}
            <a href="?{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ page_obj.next_page_number }}" 
               class="px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                <i class="fas fa-arrow-left"></i>
            </a>
            {% endif %}
        </nav>
    </div>
    {% endif %}
</div>

<script>
function applyFilters() {
    const category = document.getElementById('category-filter').value;
    const sort = document.getElementById('sort-options').value;
    
    let url = '{% url "main:questions_list" %}?';
    const params = [];
    
    if (category !== 'all') {
        params.push(`category=${category}`);
    }
    
    if (sort !== 'newest') {
        params.push(`sort=${sort}`);
    }
    
    url += params.join('&');
    window.location.href = url;
}
</script>

<style>
.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %}